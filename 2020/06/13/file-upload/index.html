<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"songqiuxiao.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="å‰æ®µæ—¶é—´é›†ä¸­å¤„ç†äº†ä¸€æ³¢ç³»ç»Ÿå†…çš„ç®€å†é—®é¢˜ã€‚å…¶ä¸­æœ‰ä¸€ä¸ª bug æ˜¯å®¢æˆ·ä¸Šä¼ çš„ä¸€å°ç®€å†ï¼Œç³»ç»Ÿå†…ä¸æ˜¾ç¤ºäº†ï¼Œä¸€ç›´æç¤ºã€Œç®€å†è½¬æ¡£ä¸­ã€ï¼Œæœ€å¼€å§‹æˆ‘æŸ¥çš„æ—¶å€™ï¼Œä»¥ä¸ºæ˜¯ç®€å† size å¤ªå¤§äº†ï¼Œå¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œåæ¥å‘ç°æ˜¯åç«¯çš„æ–‡ä»¶è½¬æ¢é—®é¢˜ã€‚ ä½†æ˜¯å¦‚æœç¡®å®æ˜¯æ–‡ä»¶å¤ªå¤§äº†æ€ä¹ˆåŠå‘¢ï¼Ÿä¸šåŠ¡åœºæ™¯ä¸Šä¸éš¾é‡åˆ°å®¢æˆ·éœ€è¦ä¸Šä¼ ä¸€ä¸ªå¤§æ–‡ä»¶çš„æƒ…å†µï¼Œå¦‚æœå¤±è´¥äº†é‡è¯•ä¹Ÿè¦å¥½åŠå¤©ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ€ä¹ˆåšæ‰èƒ½å¿«é€Ÿä¸Šä¼ ï¼Œå¹¶ä¸”å¦‚æœä¸Šä¼ å¤±è´¥äº†ï¼Œå†æ¬¡ä¸Šä¼ ä¹Ÿèƒ½ä»å¤±è´¥çš„åœ°æ–¹ç»§">
<meta property="og:type" content="article">
<meta property="og:title" content="åˆ†ç‰‡ä¸Šä¼ æ–‡ä»¶">
<meta property="og:url" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;index.html">
<meta property="og:site_name" content="å®‹ç§‹æ™“">
<meta property="og:description" content="å‰æ®µæ—¶é—´é›†ä¸­å¤„ç†äº†ä¸€æ³¢ç³»ç»Ÿå†…çš„ç®€å†é—®é¢˜ã€‚å…¶ä¸­æœ‰ä¸€ä¸ª bug æ˜¯å®¢æˆ·ä¸Šä¼ çš„ä¸€å°ç®€å†ï¼Œç³»ç»Ÿå†…ä¸æ˜¾ç¤ºäº†ï¼Œä¸€ç›´æç¤ºã€Œç®€å†è½¬æ¡£ä¸­ã€ï¼Œæœ€å¼€å§‹æˆ‘æŸ¥çš„æ—¶å€™ï¼Œä»¥ä¸ºæ˜¯ç®€å† size å¤ªå¤§äº†ï¼Œå¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œåæ¥å‘ç°æ˜¯åç«¯çš„æ–‡ä»¶è½¬æ¢é—®é¢˜ã€‚ ä½†æ˜¯å¦‚æœç¡®å®æ˜¯æ–‡ä»¶å¤ªå¤§äº†æ€ä¹ˆåŠå‘¢ï¼Ÿä¸šåŠ¡åœºæ™¯ä¸Šä¸éš¾é‡åˆ°å®¢æˆ·éœ€è¦ä¸Šä¼ ä¸€ä¸ªå¤§æ–‡ä»¶çš„æƒ…å†µï¼Œå¦‚æœå¤±è´¥äº†é‡è¯•ä¹Ÿè¦å¥½åŠå¤©ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ€ä¹ˆåšæ‰èƒ½å¿«é€Ÿä¸Šä¼ ï¼Œå¹¶ä¸”å¦‚æœä¸Šä¼ å¤±è´¥äº†ï¼Œå†æ¬¡ä¸Šä¼ ä¹Ÿèƒ½ä»å¤±è´¥çš„åœ°æ–¹ç»§">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;1.png">
<meta property="og:image" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;2.png">
<meta property="og:image" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;3.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;4.png">
<meta property="og:image" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;5.png">
<meta property="article:published_time" content="2020-06-13T07:04:05.000Z">
<meta property="article:modified_time" content="2020-08-24T07:07:38.498Z">
<meta property="article:author" content="å®‹ç§‹æ™“">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;songqiuxiao.github.io&#x2F;2020&#x2F;06&#x2F;13&#x2F;file-upload&#x2F;1.png">

<link rel="canonical" href="https://songqiuxiao.github.io/2020/06/13/file-upload/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>åˆ†ç‰‡ä¸Šä¼ æ–‡ä»¶ | å®‹ç§‹æ™“</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">å®‹ç§‹æ™“</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">You are the JavaScript in my HTML</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://songqiuxiao.github.io/2020/06/13/file-upload/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="å®‹ç§‹æ™“">
      <meta itemprop="description" content="æœˆäº®æ˜¯æˆ‘æŠ›çš„ç¡¬å¸ğŸŒ™ ä¸¤è¾¹éƒ½æ˜¯æ¢¦è§ä½ ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å®‹ç§‹æ™“">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          åˆ†ç‰‡ä¸Šä¼ æ–‡ä»¶
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-06-13 15:04:05" itemprop="dateCreated datePublished" datetime="2020-06-13T15:04:05+08:00">2020-06-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-08-24 15:07:38" itemprop="dateModified" datetime="2020-08-24T15:07:38+08:00">2020-08-24</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>å‰æ®µæ—¶é—´é›†ä¸­å¤„ç†äº†ä¸€æ³¢ç³»ç»Ÿå†…çš„ç®€å†é—®é¢˜ã€‚å…¶ä¸­æœ‰ä¸€ä¸ª bug æ˜¯å®¢æˆ·ä¸Šä¼ çš„ä¸€å°ç®€å†ï¼Œç³»ç»Ÿå†…ä¸æ˜¾ç¤ºäº†ï¼Œä¸€ç›´æç¤ºã€Œç®€å†è½¬æ¡£ä¸­ã€ï¼Œæœ€å¼€å§‹æˆ‘æŸ¥çš„æ—¶å€™ï¼Œä»¥ä¸ºæ˜¯ç®€å† size å¤ªå¤§äº†ï¼Œå¯¼è‡´ä¸Šä¼ å¤±è´¥ï¼Œåæ¥å‘ç°æ˜¯åç«¯çš„æ–‡ä»¶è½¬æ¢é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å¦‚æœç¡®å®æ˜¯æ–‡ä»¶å¤ªå¤§äº†æ€ä¹ˆåŠå‘¢ï¼Ÿä¸šåŠ¡åœºæ™¯ä¸Šä¸éš¾é‡åˆ°å®¢æˆ·éœ€è¦ä¸Šä¼ ä¸€ä¸ªå¤§æ–‡ä»¶çš„æƒ…å†µï¼Œå¦‚æœå¤±è´¥äº†é‡è¯•ä¹Ÿè¦å¥½åŠå¤©ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ€ä¹ˆåšæ‰èƒ½å¿«é€Ÿä¸Šä¼ ï¼Œå¹¶ä¸”å¦‚æœä¸Šä¼ å¤±è´¥äº†ï¼Œå†æ¬¡ä¸Šä¼ ä¹Ÿèƒ½ä»å¤±è´¥çš„åœ°æ–¹ç»§ç»­ä¸Šä¼ å’§ï¼Ÿ</p>
<a id="more"></a>

<p>çœ‹è¿‡è§†é¢‘ç½‘ç«™çš„åŠ è½½åŸç†çš„è¯ï¼Œæˆ–è®¸é©¬ä¸Šå°±èƒ½æƒ³åˆ°åˆ†ç‰‡ä¸Šä¼ ã€‚å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶åˆ‡ç‰‡æˆå¤šä¸ªå°æ–‡ä»¶ï¼Œå¹¶è¡Œè¯·æ±‚æ¥å£è¿›è¡Œä¸Šä¼ ï¼Œåœ¨æ‰€æœ‰çš„è¯·æ±‚éƒ½å¾—åˆ°å“åº”åï¼Œåœ¨æœåŠ¡ç«¯åˆå¹¶æ‰€æœ‰çš„åˆ†ç‰‡æ–‡ä»¶ã€‚å½“åˆ†ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œå¯ä»¥åœ¨é‡æ–°ä¸Šä¼ æ—¶è¿›è¡Œåˆ¤æ–­ï¼Œåªä¸Šä¼ ä¸Šæ¬¡å¤±è´¥çš„éƒ¨åˆ†ï¼Œå‡å°‘ç”¨æˆ·çš„ç­‰å¾…æ—¶é—´ï¼Œç¼“è§£æœåŠ¡å™¨å‹åŠ›ã€‚è¿™å°±æ˜¯åˆ†ç‰‡ä¸Šä¼ æ–‡ä»¶ã€‚<br>å…¶æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š<br><img src="/2020/06/13/file-upload/1.png" alt="img"></p>
<h3 id="æ–‡ä»¶-MD5-åŠ å¯†"><a href="#æ–‡ä»¶-MD5-åŠ å¯†" class="headerlink" title="æ–‡ä»¶ MD5 åŠ å¯†"></a>æ–‡ä»¶ MD5 åŠ å¯†</h3><p>MD5 æ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼Œå¯ä»¥åˆ©ç”¨æ–‡ä»¶çš„ MD5 æŸ¥è¯¢æ–‡ä»¶çš„ä¸Šä¼ çŠ¶æ€ã€‚<br>æ ¹æ®æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ã€æ–‡ä»¶åç§°ã€æœ€åä¿®æ”¹æ—¶é—´ç­‰ä¿¡æ¯ï¼Œé€šè¿‡ spark-md5 ç”Ÿæˆæ–‡ä»¶çš„ MD5ã€‚å¯¹äºå¤§è§„æ ¼æ–‡ä»¶éœ€è¦åˆ†ç‰‡è¯»å–æ–‡ä»¶ï¼Œï¼Œå°†è¯»å–çš„æ–‡ä»¶å†…å®¹æ·»åŠ åˆ° spark-md5 çš„ hash è®¡ç®—ä¸­ï¼Œç›´åˆ°æ–‡ä»¶è¯»å–å®Œæ¯•ï¼Œæœ€åè¿”å›æœ€ç»ˆçš„ hash ç åˆ°å›è°ƒå‡½æ•°é‡Œé¢ã€‚è¿™é‡Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ–‡ä»¶è¯»å–çš„è¿›åº¦æ¡æ¥å¢åŠ äº¤äº’ä½“éªŒã€‚</p>
<!-- 2è¿™é‡Œæœ€å¥½åŠ ä¸ªåŠ¨å›¾æ¼”ç¤ºä¸‹ -->

<p>å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">md5File (file) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> blobSlice =</span><br><span class="line">      File.prototype.slice ||</span><br><span class="line">      File.prototype.mozSlice ||</span><br><span class="line">      File.prototype.webkitSlice</span><br><span class="line">    <span class="keyword">let</span> chunkSize = file.size / <span class="number">100</span></span><br><span class="line">    <span class="keyword">let</span> chunks = <span class="number">100</span></span><br><span class="line">    <span class="keyword">let</span> currentChunk = <span class="number">0</span></span><br><span class="line">    <span class="keyword">let</span> spark = <span class="keyword">new</span> SparkMD5.ArrayBuffer()</span><br><span class="line">    <span class="keyword">let</span> fileReader = <span class="keyword">new</span> FileReader()</span><br><span class="line">    fileReader.onload = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'read chunk nr'</span>, currentChunk + <span class="number">1</span>, <span class="string">'of'</span>, chunks)</span><br><span class="line">      spark.append(e.target.result) <span class="comment">// Append array buffer</span></span><br><span class="line">      currentChunk++</span><br><span class="line">      <span class="keyword">if</span> (currentChunk &lt; chunks) &#123;</span><br><span class="line">        loadNext()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> cur = +<span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'finished loading'</span>)</span><br><span class="line">        <span class="keyword">let</span> result = spark.end()</span><br><span class="line">        resolve(result)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fileReader.onerror = <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.warn(<span class="string">'oops, something went wrong.'</span>)</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">loadNext</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> start = currentChunk * chunkSize</span><br><span class="line">      <span class="keyword">let</span> end =</span><br><span class="line">        start + chunkSize &gt;= file.size ? file.size : start + chunkSize</span><br><span class="line">      fileReader.readAsArrayBuffer(blobSlice.call(file, start, end))</span><br><span class="line">    &#125;</span><br><span class="line">    loadNext()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€"><a href="#æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€" class="headerlink" title="æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€"></a>æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€</h3><p>å‰ç«¯å¾—åˆ°æ–‡ä»¶çš„ MD5 åï¼Œä»åå°æŸ¥è¯¢æ˜¯å¦å­˜åœ¨åç§°ä¸º MD5 çš„æ–‡ä»¶å¤¹ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ—å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå¾—åˆ°å·²ä¸Šä¼ çš„åˆ‡ç‰‡åˆ—è¡¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å·²ä¸Šä¼ çš„åˆ‡ç‰‡åˆ—è¡¨ä¸ºç©ºã€‚<br><img src="/2020/06/13/file-upload/2.png" alt="img"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¡éªŒæ–‡ä»¶çš„MD5</span></span><br><span class="line">checkFileMD5 (file, fileName, fileMd5Value, onError) &#123;</span><br><span class="line">  <span class="keyword">const</span> fileSize = file.size</span><br><span class="line">  <span class="keyword">const</span> &#123; chunkSize, uploadProgress &#125; = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">this</span>.chunks = <span class="built_in">Math</span>.ceil(fileSize / chunkSize)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="keyword">async</span> (resolve, reject) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> params = &#123;</span><br><span class="line">      fileName: fileName,</span><br><span class="line">      fileMd5Value: fileMd5Value,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> &#123; ok, data &#125; = <span class="keyword">await</span> services.checkFile(params)</span><br><span class="line">    <span class="keyword">if</span> (ok) &#123;</span><br><span class="line">      <span class="keyword">this</span>.hasUploaded = data.chunkList.length</span><br><span class="line">      uploadProgress(file)</span><br><span class="line">      resolve(data)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      reject(ok)</span><br><span class="line">      onError()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ–‡ä»¶åˆ†ç‰‡"><a href="#æ–‡ä»¶åˆ†ç‰‡" class="headerlink" title="æ–‡ä»¶åˆ†ç‰‡"></a>æ–‡ä»¶åˆ†ç‰‡</h3><p>æ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–çš„æ ¸å¿ƒå°±æ˜¯æ–‡ä»¶åˆ†ç‰‡ï¼ŒBlob å¯¹è±¡ä¸­çš„ slice æ–¹æ³•å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œåˆ‡å‰²ï¼ŒFile å¯¹è±¡æ˜¯ç»§æ‰¿ Blob å¯¹è±¡çš„ï¼Œå› æ­¤ File å¯¹è±¡ä¹Ÿæœ‰ slice æ–¹æ³•ã€‚</p>
<p>å®šä¹‰æ¯ä¸€ä¸ªåˆ†ç‰‡æ–‡ä»¶çš„å¤§å°å˜é‡ä¸º chunkSizeï¼Œé€šè¿‡æ–‡ä»¶å¤§å° FileSize å’Œåˆ†ç‰‡å¤§å° chunkSize å¾—åˆ°åˆ†ç‰‡æ•°é‡ chunksï¼Œä½¿ç”¨ for å¾ªç¯å’Œ file.slice() æ–¹æ³•å¯¹æ–‡ä»¶è¿›è¡Œåˆ†ç‰‡ï¼Œåºå·ä¸º 0 - nï¼Œå’Œå·²ä¸Šä¼ çš„åˆ‡ç‰‡åˆ—è¡¨åšæ¯”å¯¹ï¼Œå¾—åˆ°æ‰€æœ‰æœªä¸Šä¼ çš„åˆ†ç‰‡ï¼Œpush åˆ°è¯·æ±‚åˆ—è¡¨ requestListã€‚<br><img src="/2020/06/13/file-upload/3.jpg" alt="img"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> checkAndUploadChunk (file, fileMd5Value, chunkList) &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; chunks, upload &#125; = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">const</span> requestList = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; chunks; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> exit = chunkList.indexOf(i + <span class="string">''</span>) &gt; <span class="number">-1</span></span><br><span class="line">    <span class="comment">// å¦‚æœå·²ç»å­˜åœ¨, åˆ™ä¸ç”¨å†ä¸Šä¼ å½“å‰å—</span></span><br><span class="line">    <span class="keyword">if</span> (!exit) &#123;</span><br><span class="line">      requestList.push(upload(i, fileMd5Value, file))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(&#123; requestList &#125;)</span><br><span class="line">  <span class="keyword">const</span> result =</span><br><span class="line">    requestList.length &gt; <span class="number">0</span></span><br><span class="line">      ? <span class="keyword">await</span> <span class="built_in">Promise</span>.all(requestList)</span><br><span class="line">        .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(&#123; result &#125;)</span><br><span class="line">          <span class="keyword">return</span> result.every(<span class="function"><span class="params">i</span> =&gt;</span> i.ok)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> err</span><br><span class="line">        &#125;)</span><br><span class="line">      : <span class="literal">true</span></span><br><span class="line">  <span class="built_in">console</span>.log(&#123; result &#125;)</span><br><span class="line">  <span class="keyword">return</span> result === <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸Šä¼ åˆ†ç‰‡"><a href="#ä¸Šä¼ åˆ†ç‰‡" class="headerlink" title="ä¸Šä¼ åˆ†ç‰‡"></a>ä¸Šä¼ åˆ†ç‰‡</h3><p>è°ƒç”¨ Promise.all å¹¶å‘ä¸Šä¼ æ‰€æœ‰çš„åˆ‡ç‰‡ï¼Œå°†åˆ‡ç‰‡åºå·ã€åˆ‡ç‰‡æ–‡ä»¶ã€æ–‡ä»¶ MD5 ä¼ ç»™åå°ã€‚</p>
<p>åå°æ¥æ”¶åˆ°ä¸Šä¼ è¯·æ±‚åï¼Œé¦–å…ˆæŸ¥çœ‹åç§°ä¸ºæ–‡ä»¶ MD5 çš„æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œç„¶åé€šè¿‡ fs-extra çš„ rename æ–¹æ³•ï¼Œå°†åˆ‡ç‰‡ä»ä¸´æ—¶è·¯å¾„ç§»åŠ¨åˆ‡ç‰‡æ–‡ä»¶å¤¹ä¸­ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2020/06/13/file-upload/4.png" alt="img"><br>å½“å…¨éƒ¨åˆ†ç‰‡ä¸Šä¼ æˆåŠŸï¼Œé€šçŸ¥æœåŠ¡ç«¯è¿›è¡Œåˆå¹¶ï¼Œå½“æœ‰ä¸€ä¸ªåˆ†ç‰‡ä¸Šä¼ å¤±è´¥æ—¶ï¼Œæç¤ºâ€œä¸Šä¼ å¤±è´¥â€ã€‚åœ¨é‡æ–°ä¸Šä¼ æ—¶ï¼Œé€šè¿‡æ–‡ä»¶ MD5 å¾—åˆ°æ–‡ä»¶çš„ä¸Šä¼ çŠ¶æ€ï¼Œå½“æœåŠ¡å™¨å·²ç»æœ‰è¯¥ MD5 å¯¹åº”çš„åˆ‡ç‰‡æ—¶ï¼Œä»£è¡¨è¯¥åˆ‡ç‰‡å·²ç»ä¸Šä¼ è¿‡ï¼Œæ— éœ€å†æ¬¡ä¸Šä¼ ï¼Œå½“æœåŠ¡å™¨æ‰¾ä¸åˆ°è¯¥ MD5 å¯¹åº”çš„åˆ‡ç‰‡æ—¶ï¼Œä»£è¡¨è¯¥åˆ‡ç‰‡éœ€è¦ä¸Šä¼ ï¼Œç”¨æˆ·åªéœ€ä¸Šä¼ è¿™éƒ¨åˆ†åˆ‡ç‰‡ï¼Œå°±å¯ä»¥å®Œæ•´ä¸Šä¼ æ•´ä¸ªæ–‡ä»¶ï¼Œè¿™å°±æ˜¯æ–‡ä»¶çš„æ–­ç‚¹ç»­ä¼ ã€‚</p>
<!-- 6å†æ¥ä¸ªåŠ¨å›¾æ¼”ç¤ºä¸€ä¸‹ -->

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸Šä¼ chunk</span></span><br><span class="line">upload (i, fileMd5Value, file) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; uploadProgress, chunks &#125; = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; chunkSize &#125; = <span class="keyword">this</span></span><br><span class="line">    <span class="comment">// æ„é€ ä¸€ä¸ªè¡¨å•ï¼ŒFormDataæ˜¯HTML5æ–°å¢çš„</span></span><br><span class="line">    <span class="keyword">let</span> end =</span><br><span class="line">      (i + <span class="number">1</span>) * chunkSize &gt;= file.size ? file.size : (i + <span class="number">1</span>) * chunkSize</span><br><span class="line">    <span class="keyword">let</span> form = <span class="keyword">new</span> FormData()</span><br><span class="line">    form.append(<span class="string">'data'</span>, file.slice(i * chunkSize, end)) <span class="comment">// fileå¯¹è±¡çš„sliceæ–¹æ³•ç”¨äºåˆ‡å‡ºæ–‡ä»¶çš„ä¸€éƒ¨åˆ†</span></span><br><span class="line">    form.append(<span class="string">'total'</span>, chunks) <span class="comment">// æ€»ç‰‡æ•°</span></span><br><span class="line">    form.append(<span class="string">'index'</span>, i) <span class="comment">// å½“å‰æ˜¯ç¬¬å‡ ç‰‡</span></span><br><span class="line">    form.append(<span class="string">'fileMd5Value'</span>, fileMd5Value)</span><br><span class="line">    services</span><br><span class="line">      .uploadLarge(form)</span><br><span class="line">      .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data.ok) &#123;</span><br><span class="line">          <span class="keyword">this</span>.hasUploaded++</span><br><span class="line">          uploadProgress(file)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(&#123; data &#125;)</span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        reject(err)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸Šä¼ è¿›åº¦"><a href="#ä¸Šä¼ è¿›åº¦" class="headerlink" title="ä¸Šä¼ è¿›åº¦"></a>ä¸Šä¼ è¿›åº¦</h3><p>è™½ç„¶åˆ†ç‰‡æ‰¹é‡ä¸Šä¼ æ¯”å¤§æ–‡ä»¶å•æ¬¡ä¸Šä¼ ä¼šå¿«å¾ˆå¤šï¼Œä¹Ÿè¿˜æ˜¯æœ‰ä¸€æ®µåŠ è½½æ—¶é—´ï¼Œè¿™æ—¶åº”è¯¥åŠ ä¸Šä¸Šä¼ è¿›åº¦çš„æç¤ºï¼Œå®æ—¶æ˜¾ç¤ºæ–‡ä»¶ä¸Šä¼ è¿›åº¦ã€‚</p>
<p>åŸç”Ÿ Javascript çš„ XMLHttpRequest æœ‰æä¾› progress äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè¿”å›æ–‡ä»¶å·²ä¸Šä¼ çš„å¤§å°å’Œæ€»å¤§å°ã€‚é¡¹ç›®ä½¿ç”¨ axios å¯¹ ajax è¿›è¡Œå°è£…ï¼Œå¯ä»¥åœ¨ config ä¸­å¢åŠ  onUploadProgress æ–¹æ³•ï¼Œç›‘å¬æ–‡ä»¶ä¸Šä¼ è¿›åº¦ã€‚</p>
<!-- 7åŠ¨å›¾æ¼”ç¤º -->

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  onUploadProgress: <span class="function">(<span class="params">progressEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> complete =</span><br><span class="line">      (((progressEvent.loaded / progressEvent.total) * <span class="number">100</span>) | <span class="number">0</span>) + <span class="string">"%"</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">services.uploadChunk(form, config);</span><br></pre></td></tr></table></figure>

<h3 id="åˆå¹¶åˆ†ç‰‡"><a href="#åˆå¹¶åˆ†ç‰‡" class="headerlink" title="åˆå¹¶åˆ†ç‰‡"></a>åˆå¹¶åˆ†ç‰‡</h3><p>ä¸Šä¼ å®Œæ‰€æœ‰æ–‡ä»¶åˆ†ç‰‡åï¼Œå‰ç«¯ä¸»åŠ¨é€šçŸ¥æœåŠ¡ç«¯è¿›è¡Œåˆå¹¶ï¼ŒæœåŠ¡ç«¯æ¥å—åˆ°è¿™ä¸ªè¯·æ±‚æ—¶ä¸»åŠ¨åˆå¹¶åˆ‡ç‰‡ï¼Œé€šè¿‡æ–‡ä»¶ MD5 åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ä¸Šä¼ è·¯å¾„ä¸­æ‰¾åˆ°åŒåæ–‡ä»¶å¤¹ã€‚ä»ä¸Šæ–‡å¯çŸ¥ï¼Œæ–‡ä»¶åˆ†ç‰‡æ˜¯æŒ‰ç…§åˆ†ç‰‡åºå·å‘½åçš„ï¼Œè€Œåˆ†ç‰‡ä¸Šä¼ æ¥å£æ˜¯å¼‚æ­¥çš„ï¼Œæ— æ³•ä¿è¯æœåŠ¡å™¨æ¥æ”¶åˆ°çš„åˆ‡ç‰‡æ˜¯æŒ‰ç…§è¯·æ±‚é¡ºåºæ‹¼æ¥ã€‚æ‰€ä»¥åº”è¯¥åœ¨åˆå¹¶æ–‡ä»¶å¤¹é‡Œçš„åˆ†ç‰‡æ–‡ä»¶å‰ï¼Œæ ¹æ®æ–‡ä»¶åè¿›è¡Œæ’åºï¼Œç„¶åå†é€šè¿‡ concat-files åˆå¹¶åˆ†ç‰‡æ–‡ä»¶ï¼Œå¾—åˆ°ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ã€‚è‡³æ­¤å¤§æ–‡ä»¶ä¸Šä¼ å°±å®Œæˆäº†ã€‚<br><img src="/2020/06/13/file-upload/5.png" alt="img"></p>
<p>Node ç«¯ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> concatFiles = <span class="built_in">require</span>(<span class="string">"concat-files"</span>);</span><br><span class="line"></span><br><span class="line">app.all(<span class="string">"/merge"</span>, (req, resp) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> query = req.query;</span><br><span class="line">  <span class="keyword">let</span> md5 = query.md5;</span><br><span class="line">  <span class="keyword">let</span> size = query.size;</span><br><span class="line">  <span class="keyword">let</span> fileName = query.fileName;</span><br><span class="line">  <span class="built_in">console</span>.log(md5, fileName);</span><br><span class="line">  mergeFiles(path.join(uploadDir, md5), uploadDir, fileName, size);</span><br><span class="line">  resp.send(&#123;</span><br><span class="line">    code: <span class="number">1</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">mergeFiles</span>(<span class="params">srcDir, targetDir, newFileName, size</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(...arguments);</span><br><span class="line">  <span class="keyword">let</span> targetStream = fs.createWriteStream(path.join(targetDir, newFileName));</span><br><span class="line">  <span class="keyword">let</span> fileArr = <span class="keyword">await</span> listDir(srcDir);</span><br><span class="line">  fileArr.sort(<span class="function">(<span class="params">x, y</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x - y;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// æŠŠæ–‡ä»¶ååŠ ä¸Šæ–‡ä»¶å¤¹çš„å‰ç¼€</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; fileArr.length; i++) &#123;</span><br><span class="line">    fileArr[i] = srcDir + <span class="string">"/"</span> + fileArr[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(fileArr);</span><br><span class="line">  concatFiles(fileArr, path.join(targetDir, newFileName), () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Merge Success!"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬æ–‡è®²è¿°äº†å¤§è§„æ ¼æ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–çš„ä¸€äº›åšæ³•ï¼Œæ€»ç»“ä¸ºä»¥ä¸‹ 4 ç‚¹ï¼š</p>
<ul>
<li>spark-md5 æ ¹æ®æ–‡ä»¶å†…å®¹ç®—å‡ºæ–‡ä»¶ MD5ï¼Œå¾—åˆ°æ–‡ä»¶å”¯ä¸€æ ‡è¯†ï¼Œä¸æ–‡ä»¶ä¸Šä¼ çŠ¶æ€ç»‘å®šï¼›</li>
<li>åˆ†ç‰‡ä¸Šä¼ å‰é€šè¿‡æ–‡ä»¶ MD5 æŸ¥è¯¢å·²ä¸Šä¼ åˆ‡ç‰‡åˆ—è¡¨ï¼Œä¸Šä¼ æ—¶åªä¸Šä¼ æœªä¸Šä¼ è¿‡çš„åˆ‡ç‰‡ï¼Œå®ç°æ–­ç‚¹ç»­ä¼ ã€‚</li>
<li>Blob.slice å°†æ–‡ä»¶åˆ‡ç‰‡ï¼Œå¹¶å‘ä¸Šä¼ å¤šä¸ªåˆ‡ç‰‡ï¼Œæ‰€æœ‰åˆ‡ç‰‡ä¸Šä¼ åå‘ŠçŸ¥æœåŠ¡å™¨åˆå¹¶ï¼Œå®ç°å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ï¼›</li>
<li>åŸç”Ÿ XMLHttpRequest çš„ onprogress å¯¹åˆ‡ç‰‡ä¸Šä¼ è¿›åº¦çš„ç›‘å¬ï¼Œå®æ—¶è·å–æ–‡ä»¶ä¸Šä¼ è¿›åº¦ï¼›</li>
</ul>
<p><a href="https://github.com/songQiuXiao/file-uplode-demo" target="_blank" rel="noopener">æºç å¯ä»¥åº·åº·è¿™é‡Œ</a></p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob" target="_blank" rel="noopener">Blob å¯¹è±¡çš„ä½¿ç”¨</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData/Using_FormData_Objects" target="_blank" rel="noopener">FormData å¯¹è±¡çš„ä½¿ç”¨</a></li>
<li><a href="https://www.npmjs.com/package/concat-files" target="_blank" rel="noopener">npm: concat-files</a><!-- - https://aotu.io/notes/2020/05/12/file-upload/ -->
</li>
</ul>

    </div>

    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div>
    
</div>
      
    </div>

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/05/07/operator/" rel="prev" title="å†™å†™æ“ä½œç¬¦">
      <i class="fa fa-chevron-left"></i> å†™å†™æ“ä½œç¬¦
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/22/about-babel/" rel="next" title="å†™å†™Babelæ’ä»¶">
      å†™å†™Babelæ’ä»¶ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–‡ä»¶-MD5-åŠ å¯†"><span class="nav-number">1.</span> <span class="nav-text">æ–‡ä»¶ MD5 åŠ å¯†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€"><span class="nav-number">2.</span> <span class="nav-text">æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–‡ä»¶åˆ†ç‰‡"><span class="nav-number">3.</span> <span class="nav-text">æ–‡ä»¶åˆ†ç‰‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸Šä¼ åˆ†ç‰‡"><span class="nav-number">4.</span> <span class="nav-text">ä¸Šä¼ åˆ†ç‰‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸Šä¼ è¿›åº¦"><span class="nav-number">5.</span> <span class="nav-text">ä¸Šä¼ è¿›åº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆå¹¶åˆ†ç‰‡"><span class="nav-number">6.</span> <span class="nav-text">åˆå¹¶åˆ†ç‰‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">7.</span> <span class="nav-text">æ€»ç»“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‚è€ƒèµ„æ–™"><span class="nav-number">8.</span> <span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="å®‹ç§‹æ™“"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">å®‹ç§‹æ™“</p>
  <div class="site-description" itemprop="description">æœˆäº®æ˜¯æˆ‘æŠ›çš„ç¡¬å¸ğŸŒ™ ä¸¤è¾¹éƒ½æ˜¯æ¢¦è§ä½ </div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å®‹ç§‹æ™“</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
  1
  <script type="text/javascript" src="/js/love.js"></script>
</body>
</html>
